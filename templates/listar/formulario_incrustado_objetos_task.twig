{% extends 'base.html.twig' %}

{% block title %}Hello ContactController!{% endblock %}

{% block body %}

<script>

window.onload = function(){
    
    console.log("cargado");

    // listener button
    document
        .querySelectorAll('.add_item_link')
        .forEach(btn => {
            btn.addEventListener("click", addFormToCollection)
        });
}


const addFormToCollection = (e) => {
  
  const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);
  const item = document.createElement('li');
  console.log(e.currentTarget.dataset); 
   
    
  item.innerHTML = collectionHolder
    .dataset
    .prototype
    .replace(/__name__/g,collectionHolder.dataset.index);

  collectionHolder.appendChild(item);
  collectionHolder.dataset.index++;
  

};

</script>

<h1>Contact us</h1>
<p>This is a simple contact form</p>

{#% do form.task.setRendered %#}
{{ form_start(form) }}
    <!-- campos -->
    {{ form_row(form.task) }}
    {{ form_row(form.dueDate) }}
    {{ form_row(form.category) }}
    
    <!-- colecciÃ³n -->
    <h3>Tags</h3>
    <ul class="tags" data-index="{{ form.tags|length > 0 ? form.tags|last.vars.name + 1 : 0 }}"
    data-prototype="{{ form_widget(form.tags.vars.prototype)|e('html_attr') }}">
        {% for tag in form.tags %}
            <li>{{ form_row(tag.name) }}</li>
        {% endfor %}
    </ul>
    
    <button type="button" class="add_item_link" data-collection-holder-class="tags">Add a tag</button>
    
    <!-- submit formulario | errores | ayuda -->
    {{ form_row(form.save) }}
    {{ form_errors(form) }}
    {{ form_help(form) }}
    {{ form_rest(form) }}

{{ form_end(form) }}


{% for message in app.flashes('success') %}
    <div class="alert alert-success">
        {{ message }}
    </div>
{% endfor %}

{% endblock %}